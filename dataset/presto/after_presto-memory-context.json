[{"methodBody": ["METHOD_START", "{", "usedBytes    =    AggregatedMemoryContext . addExact ( usedBytes ,    bytes )  ;", "}", "METHOD_END"], "methodName": ["addBytes"], "fileName": "com.facebook.presto.memory.context.AggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "try    {", "return   Math . addExact ( usedBytes ,    bytes )  ;", "}    catch    ( ArithmeticException   e )     {", "throw   new   RuntimeException ( String . format (  \" Overflow   detec .    usedBytes :     % d ,    bytes :     % d \"  ,    usedBytes ,    bytes )  ,    e )  ;", "}", "}", "METHOD_END"], "methodName": ["addExact"], "fileName": "com.facebook.presto.memory.context.AggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "if    ( closed )     {", "return ;", "}", "closed    =    true ;", "close (  )  ;", "usedBytes    =     0  ;", "}", "METHOD_END"], "methodName": ["close"], "fileName": "com.facebook.presto.memory.context.AggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "return   usedBytes ;", "}", "METHOD_END"], "methodName": ["getBytes"], "fileName": "com.facebook.presto.memory.context.AggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "return   new   ChildAggregatedMemoryContext ( this )  ;", "}", "METHOD_END"], "methodName": ["newAggregatedMemoryContext"], "fileName": "com.facebook.presto.memory.context.AggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "return   new   SimpleLocalMemoryContext ( this )  ;", "}", "METHOD_END"], "methodName": ["newLocalMemoryContext"], "fileName": "com.facebook.presto.memory.context.AggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "return   new   RootAggregatedMemoryContext ( reservationHandler ,    guaranteedMemoryInBytes )  ;", "}", "METHOD_END"], "methodName": ["newRootAggregatedMemoryContext"], "fileName": "com.facebook.presto.memory.context.AggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "return   new   SimpleAggregatedMemoryContext (  )  ;", "}", "METHOD_END"], "methodName": ["newSimpleAggregatedMemoryContext"], "fileName": "com.facebook.presto.memory.context.AggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "parentMemoryContext . updateBytes (  (  -  ( getBytes (  )  )  )  )  ;", "}", "METHOD_END"], "methodName": ["closeContext"], "fileName": "com.facebook.presto.memory.context.ChildAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "return   parentMemoryContext ;", "}", "METHOD_END"], "methodName": ["getParent"], "fileName": "com.facebook.presto.memory.context.ChildAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "if    ( parentMemoryContext . tryUpdateBytes ( delta )  )     {", "addBytes ( delta )  ;", "return   true ;", "}", "return   false ;", "}", "METHOD_END"], "methodName": ["tryUpdateBytes"], "fileName": "com.facebook.presto.memory.context.ChildAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "ListenableFuture <  ?  >    future    =    parentMemoryContext . updateBytes ( bytes )  ;", "addBytes ( bytes )  ;", "return   future ;", "}", "METHOD_END"], "methodName": ["updateBytes"], "fileName": "com.facebook.presto.memory.context.ChildAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "try    ( Closer   closer    =    Closer . create (  )  )     {", "closer . register ( userAggregateMemory :  : close )  ;", "closer . register ( revocableAggregateMemory :  : close )  ;", "closer . register ( systemAggregateMemory :  : close )  ;", "closer . register ( userLocalMemory :  : close )  ;", "closer . register ( revocableLocalMemory :  : close )  ;", "closer . register ( systemLocalMemory :  : close )  ;", "}    catch    ( IOException   e )     {", "throw   new   RuntimeException (  \" Exception   closing   memory   tracking   context \"  ,    e )  ;", "}", "}", "METHOD_END"], "methodName": ["close"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   revocableAggregateMemoryContext . getBytes (  )  ;", "}", "METHOD_END"], "methodName": ["getRevocableMemory"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   systemAggregateMemoryContext . getBytes (  )  ;", "}", "METHOD_END"], "methodName": ["getSystemMemory"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   userAggregateMemoryContext . getBytes (  )  ;", "}", "METHOD_END"], "methodName": ["getUserMemory"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   revocableLocalMemoryContext ;", "}", "METHOD_END"], "methodName": ["localRevocableMemoryContext"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   systemLocalMemoryContext ;", "}", "METHOD_END"], "methodName": ["localSystemMemoryContext"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   userLocalMemoryContext ;", "}", "METHOD_END"], "methodName": ["localUserMemoryContext"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   systemAggregateMemoryContext . newAggregatedMemoryContext (  )  ;", "}", "METHOD_END"], "methodName": ["newAggregateSystemMemoryContext"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   new   MemoryTrackingContext ( userAggregateMemoryContext . newAggregatedMemoryContext (  )  ,    revocableAggregateMemoryContext . newAggregatedMemoryContext (  )  ,    systemAggregateMemoryContext . newAggregatedMemoryContext (  )  )  ;", "}", "METHOD_END"], "methodName": ["newMemoryTrackingContext"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   systemAggregateMemoryContext . newLocalMemoryContext (  )  ;", "}", "METHOD_END"], "methodName": ["newSystemMemoryContext"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "return   userAggregateMemoryContext . newLocalMemoryContext (  )  ;", "}", "METHOD_END"], "methodName": ["newUserMemoryContext"], "fileName": "com.facebook.presto.memory.context.MemoryTrackingContext"}, {"methodBody": ["METHOD_START", "{", "reservationHandler . reserveMemory (  (  -  ( getBytes (  )  )  )  )  ;", "}", "METHOD_END"], "methodName": ["closeContext"], "fileName": "com.facebook.presto.memory.context.RootAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "return   null ;", "}", "METHOD_END"], "methodName": ["getParent"], "fileName": "com.facebook.presto.memory.context.RootAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "if    ( reservationHandler . tryReserveMemory ( delta )  )     {", "addBytes ( delta )  ;", "return   true ;", "}", "return   false ;", "}", "METHOD_END"], "methodName": ["tryUpdateBytes"], "fileName": "com.facebook.presto.memory.context.RootAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "ListenableFuture <  ?  >    future    =    reservationHandler . reserveMemory ( bytes )  ;", "addBytes ( bytes )  ;", "if    (  ( getBytes (  )  )     <     ( guaranteedMemory )  )     {", "future    =     . NOT _ BLOCKED ;", "}", "return   future ;", "}", "METHOD_END"], "methodName": ["updateBytes"], "fileName": "com.facebook.presto.memory.context.RootAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "return   null ;", "}", "METHOD_END"], "methodName": ["getParent"], "fileName": "com.facebook.presto.memory.context.SimpleAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "addBytes ( delta )  ;", "return   true ;", "}", "METHOD_END"], "methodName": ["tryUpdateBytes"], "fileName": "com.facebook.presto.memory.context.SimpleAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "addBytes ( bytes )  ;", "return    . NOT _ BLOCKED ;", "}", "METHOD_END"], "methodName": ["updateBytes"], "fileName": "com.facebook.presto.memory.context.SimpleAggregatedMemoryContext"}, {"methodBody": ["METHOD_START", "{", "usedBytes    =    AggregatedMemoryContext . addExact ( usedBytes ,    bytes )  ;", "}", "METHOD_END"], "methodName": ["addBytes"], "fileName": "com.facebook.presto.memory.context.SimpleLocalMemoryContext"}, {"methodBody": ["METHOD_START", "{", "AggregatedMemoryContext   parent    =    parentMemoryContext ;", "while    (  ( parent    !  =    null )     &  &     ( parent    !  =     ( target . parentMemoryContext )  )  )     {", "parent    =    parent . getParent (  )  ;", "}", "checkState (  ( parent    !  =    null )  ,     \" memory   context   state   is   corrupt \"  )  ;", "}", "METHOD_END"], "methodName": ["checkMemoryContextState"], "fileName": "com.facebook.presto.memory.context.SimpleLocalMemoryContext"}, {"methodBody": ["METHOD_START", "{", "long   maxMemory    =     2     *     ( TestMemoryContexts . GUARANTEED _ MEMORY )  ;", "TestMemoryContexts . TestMemoryReservationHandler   reservationHandler    =    new   TestMemoryContexts . TestMemoryReservationHandler ( maxMemory )  ;", "AggregatedMemoryContext   parentContext    =    AggregatedMemoryContext . newRootAggregatedMemoryContext ( reservationHandler ,    TestMemoryContexts . GUARANTEED _ MEMORY )  ;", "LocalMemoryContext   childContext    =    parentContext . newLocalMemoryContext (  )  ;", "reservationHandler . exhaustMemory (  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,    maxMemory )  ;", "assertEquals ( childContext . setBytes (  1  0  0  0  )  ,    TestMemoryContexts . NOT _ BLOCKED )  ;", "assertNotEquals ( childContext . setBytes (  (  ( TestMemoryContexts . GUARANTEED _ MEMORY )     +     1  )  )  ,    TestMemoryContexts . NOT _ BLOCKED )  ;", "childContext . close (  )  ;", "parentContext . close (  )  ;", "assertEquals ( childContext . getBytes (  )  ,     0  )  ;", "assertEquals ( parentContext . getBytes (  )  ,     0  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,    maxMemory )  ;", "}", "METHOD_END"], "methodName": ["testGuaranteedMemoryDoesntBlock"], "fileName": "com.facebook.presto.memory.context.TestMemoryContexts"}, {"methodBody": ["METHOD_START", "{", "TestMemoryContexts . TestMemoryReservationHandler   reservationHandler    =    new   TestMemoryContexts . TestMemoryReservationHandler (  1  0  0  0  )  ;", "AggregatedMemoryContext   parentContext    =    AggregatedMemoryContext . newRootAggregatedMemoryContext ( reservationHandler ,    TestMemoryContexts . GUARANTEED _ MEMORY )  ;", "AggregatedMemoryContext   aggregateContext 1     =    parentContext . newAggregatedMemoryContext (  )  ;", "AggregatedMemoryContext   aggregateContext 2     =    parentContext . newAggregatedMemoryContext (  )  ;", "LocalMemoryContext   childContext 1     =    aggregateContext 1  . newLocalMemoryContext (  )  ;", "LocalMemoryContext   childContext 2     =    aggregateContext 2  . newLocalMemoryContext (  )  ;", "assertEquals ( childContext 1  . setBytes (  1  )  ,    TestMemoryContexts . NOT _ BLOCKED )  ;", "assertEquals ( childContext 2  . setBytes (  1  )  ,    TestMemoryContexts . NOT _ BLOCKED )  ;", "assertEquals ( aggregateContext 1  . getBytes (  )  ,     1  )  ;", "assertEquals ( aggregateContext 2  . getBytes (  )  ,     1  )  ;", "assertEquals ( parentContext . getBytes (  )  ,     (  ( aggregateContext 1  . getBytes (  )  )     +     ( aggregateContext 2  . getBytes (  )  )  )  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,    parentContext . getBytes (  )  )  ;", "}", "METHOD_END"], "methodName": ["testHieararchicalMemoryContexts"], "fileName": "com.facebook.presto.memory.context.TestMemoryContexts"}, {"methodBody": ["METHOD_START", "{", "TestMemoryContexts . TestMemoryReservationHandler   reservationHandler    =    new   TestMemoryContexts . TestMemoryReservationHandler (  1  0  0  0  )  ;", "AggregatedMemoryContext   aggregateContext    =    AggregatedMemoryContext . newRootAggregatedMemoryContext ( reservationHandler ,    TestMemoryContexts . GUARANTEED _ MEMORY )  ;", "LocalMemoryContext   localContext    =    aggregateContext . newLocalMemoryContext (  )  ;", "localContext . setBytes (  1  0  0  )  ;", "assertEquals ( localContext . getBytes (  )  ,     1  0  0  )  ;", "assertEquals ( aggregateContext . getBytes (  )  ,     1  0  0  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,     1  0  0  )  ;", "localContext . close (  )  ;", "assertEquals ( localContext . getBytes (  )  ,     0  )  ;", "assertEquals ( aggregateContext . getBytes (  )  ,     0  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,     0  )  ;", "}", "METHOD_END"], "methodName": ["testLocalMemoryContextClose"], "fileName": "com.facebook.presto.memory.context.TestMemoryContexts"}, {"methodBody": ["METHOD_START", "{", "TestMemoryContexts . TestMemoryReservationHandler   reservationHandler    =    new   TestMemoryContexts . TestMemoryReservationHandler (  1  0  0  0  )  ;", "AggregatedMemoryContext   aggregateContext    =    AggregatedMemoryContext . newRootAggregatedMemoryContext ( reservationHandler ,    TestMemoryContexts . GUARANTEED _ MEMORY )  ;", "LocalMemoryContext   localContext    =    aggregateContext . newLocalMemoryContext (  )  ;", "assertEquals ( localContext . setBytes (  1  0  )  ,    TestMemoryContexts . NOT _ BLOCKED )  ;", "assertEquals ( localContext . getBytes (  )  ,     1  0  )  ;", "assertEquals ( aggregateContext . getBytes (  )  ,     1  0  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,    aggregateContext . getBytes (  )  )  ;", "LocalMemoryContext   secondLocalContext    =    aggregateContext . newLocalMemoryContext (  )  ;", "assertEquals ( secondLocalContext . setBytes (  2  0  )  ,    TestMemoryContexts . NOT _ BLOCKED )  ;", "assertEquals ( secondLocalContext . getBytes (  )  ,     2  0  )  ;", "assertEquals ( aggregateContext . getBytes (  )  ,     3  0  )  ;", "assertEquals ( localContext . getBytes (  )  ,     1  0  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,    aggregateContext . getBytes (  )  )  ;", "aggregateContext . close (  )  ;", "assertEquals ( aggregateContext . getBytes (  )  ,     0  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,     0  )  ;", "}", "METHOD_END"], "methodName": ["testMemoryContexts"], "fileName": "com.facebook.presto.memory.context.TestMemoryContexts"}, {"methodBody": ["METHOD_START", "{", "TestMemoryContexts . TestMemoryReservationHandler   reservationHandler    =    new   TestMemoryContexts . TestMemoryReservationHandler (  1  0  0  0  )  ;", "AggregatedMemoryContext   taskContext    =    AggregatedMemoryContext . newRootAggregatedMemoryContext ( reservationHandler ,    TestMemoryContexts . GUARANTEED _ MEMORY )  ;", "LocalMemoryContext   taskLocalMemoryContext    =    taskContext . newLocalMemoryContext (  )  ;", "AggregatedMemoryContext   pipelineContext    =    taskContext . newAggregatedMemoryContext (  )  ;", "AggregatedMemoryContext   driverContext    =    pipelineContext . newAggregatedMemoryContext (  )  ;", "AggregatedMemoryContext   operatorContext    =    driverContext . newAggregatedMemoryContext (  )  ;", "LocalMemoryContext   operatorLocalMemoryContext    =    operatorContext . newLocalMemoryContext (  )  ;", "operatorLocalMemoryContext . setBytes (  1  0  )  ;", "assertEquals ( taskContext . getBytes (  )  ,     1  0  )  ;", "assertEquals ( pipelineContext . getBytes (  )  ,     1  0  )  ;", "assertEquals ( driverContext . getBytes (  )  ,     1  0  )  ;", "assertEquals ( operatorContext . getBytes (  )  ,     1  0  )  ;", "assertEquals ( taskLocalMemoryContext . getBytes (  )  ,     0  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,     1  0  )  ;", "operatorLocalMemoryContext . transferMemory ( taskLocalMemoryContext )  ;", "assertEquals ( operatorLocalMemoryContext . getBytes (  )  ,     0  )  ;", "assertEquals ( operatorContext . getBytes (  )  ,     0  )  ;", "assertEquals ( pipelineContext . getBytes (  )  ,     0  )  ;", "assertEquals ( driverContext . getBytes (  )  ,     0  )  ;", "assertEquals ( taskContext . getBytes (  )  ,     1  0  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,     1  0  )  ;", "}", "METHOD_END"], "methodName": ["testTransferMemory"], "fileName": "com.facebook.presto.memory.context.TestMemoryContexts"}, {"methodBody": ["METHOD_START", "{", "TestMemoryContexts . TestMemoryReservationHandler   reservationHandler    =    new   TestMemoryContexts . TestMemoryReservationHandler (  1  0  0  0  )  ;", "AggregatedMemoryContext   parentContext    =    AggregatedMemoryContext . newRootAggregatedMemoryContext ( reservationHandler ,    TestMemoryContexts . GUARANTEED _ MEMORY )  ;", "AggregatedMemoryContext   aggregateContext 1     =    parentContext . newAggregatedMemoryContext (  )  ;", "AggregatedMemoryContext   aggregateContext 2     =    parentContext . newAggregatedMemoryContext (  )  ;", "LocalMemoryContext   childContext 1     =    aggregateContext 1  . newLocalMemoryContext (  )  ;", "assertTrue ( childContext 1  . trySetBytes (  5  0  0  )  )  ;", "assertTrue ( childContext 1  . trySetBytes (  1  0  0  0  )  )  ;", "assertFalse ( childContext 1  . trySetBytes (  1  0  0  1  )  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,    parentContext . getBytes (  )  )  ;", "aggregateContext 1  . close (  )  ;", "aggregateContext 2  . close (  )  ;", "parentContext . close (  )  ;", "assertEquals ( aggregateContext 1  . getBytes (  )  ,     0  )  ;", "assertEquals ( aggregateContext 2  . getBytes (  )  ,     0  )  ;", "assertEquals ( parentContext . getBytes (  )  ,     0  )  ;", "assertEquals ( reservationHandler . getReservation (  )  ,     0  )  ;", "}", "METHOD_END"], "methodName": ["testTryReserve"], "fileName": "com.facebook.presto.memory.context.TestMemoryContexts"}]