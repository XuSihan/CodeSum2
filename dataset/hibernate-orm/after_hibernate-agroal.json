[{"methodBody": ["METHOD_START", "{", "String   value    =    properties . get ( key )  ;", "if    ( value    !  =    null )     {", "consumer . accept ( conver . apply ( value )  )  ;", "}", "}", "METHOD_END"], "methodName": ["copyProperty"], "fileName": "org.hibernate.agroal.internal.AgroalConnectionProvider"}, {"methodBody": ["METHOD_START", "{", "Integer   isolation    =    ConnectionProviderInitiator . extractIsolation ( properties )  ;", "if    ( isolation    !  =    null )     {", "String   isolationString    =    ConnectionProviderInitiator . toIsolationNiceName ( isolation )  ;", "cf . jdbcTransactionIsolation ( TransactionIsolation . valueOf ( isolationString )  )  ;", "}", "}", "METHOD_END"], "methodName": ["resolveIsolationSetting"], "fileName": "org.hibernate.agroal.internal.AgroalConnectionProvider"}, {"methodBody": ["METHOD_START", "{", "JdbcServices   jdbcServices    =    serviceRegistry (  )  . getService ( JdbcServices . class )  ;", "ConnectionProviderJdbcConnectionAccess   connectionAccess    =    assertTyping ( ConnectionProviderJdbcConnectionAccess . class ,    jdbcServices . getBootstrapJdbcConnectionAccess (  )  )  ;", "assertTyping (  . class ,    connectionAccess . getConnectionProvider (  )  )  ;", "agroalConnectionProvider    =     (  (  )     ( connectionAccess . getConnectionProvider (  )  )  )  ;", "List < Connection >    conns    =    new   ArrayList <  >  (  )  ;", "for    ( int   i    =     0  ;    i    <     2  ;    i +  +  )     {", "Connection   conn    =    agroalConnectionProvider . getConnection (  )  ;", "assertNotNull ( conn )  ;", "assertFalse ( conn . isClosed (  )  )  ;", "conns . add ( conn )  ;", "}", "try    {", "agroalConnectionProvider . getConnection (  )  ;", "fail (  \" SQLException   expected    -  -    no   more   connections   should   have   been   available   in   the   pool .  \"  )  ;", "}    catch    ( SQLException   e )     {", "assertTrue ( e . getMessage (  )  . contains (  \" timeout \"  )  )  ;", "}", "for    ( Connection   conn    :    conns )     {", "agroalConnectionProvider . closeConnection ( conn )  ;", "assertTrue ( conn . isClosed (  )  )  ;", "}", "releaseSessionFactory (  )  ;", "try    {", "agroalConnectionProvider . getConnection (  )  ;", "fail (  \" Exception   expected    -  -    the   pool   should   have   been   shutdown .  \"  )  ;", "}    catch    ( Exception   e )     {", "assertTrue ( e . getMessage (  )  . contains (  \" closed \"  )  )  ;", "}", "}", "METHOD_END"], "methodName": ["testAgroalConnectionProvider"], "fileName": "org.hibernate.test.agroal.AgroalConnectionProviderTest"}, {"methodBody": ["METHOD_START", "{", "connectionProvider . clear (  )  ;", "doInH ( this :  : sessionFactory ,     (    session )     -  >     {", "City   city    =    new   City (  )  ;", "city . setId (  1 L )  ;", "city . setName (  \" Cluj - Napoca \"  )  ;", "session . persist ( city )  ;", "assertTrue ( connectionProvider . getAcquiredConnections (  )  . isEmpty (  )  )  ;", "assertTrue ( connectionProvider . getReleasedConnections (  )  . isEmpty (  )  )  ;", "}  )  ;", "verifyConnections (  )  ;", "connectionProvider . clear (  )  ;", "doInH ( this :  : sessionFactory ,     (    session )     -  >     {", "City   city    =    session . find (  . class ,     1 L )  ;", "assertEquals (  \" Cluj - Napoca \"  ,    city . getName (  )  )  ;", "}  )  ;", "verifyConnections (  )  ;", "}", "METHOD_END"], "methodName": ["test"], "fileName": "org.hibernate.test.agroal.AgroalSkipAutoCommitTest"}, {"methodBody": ["METHOD_START", "{", "assertTrue ( connectionProvider . getAcquiredConnections (  )  . isEmpty (  )  )  ;", "List < Connection >    connections    =    connectionProvider . getReleasedConnections (  )  ;", "assertEquals (  1  ,    connections . size (  )  )  ;", "Connection   connection    =    connections . get (  0  )  ;", "try    {", "verify ( connection ,    never (  )  )  . set ( false )  ;", "}    catch    ( SQLException   e )     {", "fail ( e . getMessage (  )  )  ;", "}", "}", "METHOD_END"], "methodName": ["verifyConnections"], "fileName": "org.hibernate.test.agroal.AgroalSkipAutoCommitTest"}, {"methodBody": ["METHOD_START", "{", "return   super . getConnection (  )  ;", "}", "METHOD_END"], "methodName": ["actualConnection"], "fileName": "org.hibernate.test.agroal.util.PreparedStatementSpyConnectionProvider"}, {"methodBody": ["METHOD_START", "{", "acquiredConnections . clear (  )  ;", "releasedConnections . clear (  )  ;", "pMap . keySet (  )  . forEach ( Mockito :  : reset )  ;", "pMap . clear (  )  ;", "}", "METHOD_END"], "methodName": ["clear"], "fileName": "org.hibernate.test.agroal.util.PreparedStatementSpyConnectionProvider"}, {"methodBody": ["METHOD_START", "{", "return   acquiredConnections ;", "}", "METHOD_END"], "methodName": ["getAcquiredConnections"], "fileName": "org.hibernate.test.agroal.util.PreparedStatementSpyConnectionProvider"}, {"methodBody": ["METHOD_START", "{", "return   releasedConnections ;", "}", "METHOD_END"], "methodName": ["getReleasedConnections"], "fileName": "org.hibernate.test.agroal.util.PreparedStatementSpyConnectionProvider"}, {"methodBody": ["METHOD_START", "{", "if    ( MockUtil . isMock ( connection )  )     {", "return   connection ;", "}", "Connection   connectionSpy    =    Mockito . spy ( connection )  ;", "try    {", "Mockito . doAnswer (  (    invocation )     -  >     {", "statement    =     (  (  )     ( invocation . callRealMethod (  )  )  )  ;", "statementSpy    =    Mockito . spy ( statement )  ;", "String   sql    =     (  ( String )     ( invocation . getArguments (  )  [  0  ]  )  )  ;", "preparedStatementMap . put ( statementSpy ,    sql )  ;", "return   statementSpy ;", "}  )  . when ( connectionSpy )  . prepareStatement ( ArgumentMatchers . anyString (  )  )  ;", "Mockito . doAnswer (  (    invocation )     -  >     {", "Statement   statement    =     (  ( Statement )     ( invocation . callRealMethod (  )  )  )  ;", "Statement   statementSpy    =    Mockito . spy ( statement )  ;", "return   statementSpy ;", "}  )  . when ( connectionSpy )  . createStatement (  )  ;", "}    catch    ( SQLException   e )     {", "throw   new   IllegalArgumentException ( e )  ;", "}", "return   connectionSpy ;", "}", "METHOD_END"], "methodName": ["spy"], "fileName": "org.hibernate.test.agroal.util.PreparedStatementSpyConnectionProvider"}]